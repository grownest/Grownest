<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carousel Button Test - Grow Nest</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-controls {
            background: #f0f3f7;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 12px;
            border: 2px solid #5B2AE0;
        }
        .test-button {
            background: #5B2AE0;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            margin: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }
        .test-button:hover {
            background: #4A1FB8;
        }
        .test-results {
            background: #fff;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        .status-info {
            background: #e8f4fd;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }
        .test-section {
            margin: 2rem 0;
            padding: 1.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="logo-section">
                <a href="/" class="logo" aria-label="Grow Nest - Go to homepage">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 160 40" role="img" class="logo-svg">
                        <title>Grow Nest</title>
                        <defs>
                            <style>
                                .logo-text {
                                    font-family: 'Inter', 'SF Pro Display', system-ui, -apple-system, sans-serif;
                                    font-weight: 600;
                                    letter-spacing: 0.02em;
                                    fill: currentColor;
                                }
                                .logo-bold { font-weight: 700; }
                                .logo-accent { fill: #FF9F1C; }
                            </style>
                        </defs>
                        <text x="8" y="28" class="logo-text" font-size="22">
                            <tspan class="logo-bold">G</tspan>row
                        </text>
                        <text x="84" y="28" class="logo-text" font-size="22">
                            <tspan class="logo-bold">N</tspan>est
                        </text>
                        <circle cx="152" cy="24" r="3" class="logo-accent"/>
                        <path d="M150 22 L154 20 L152 24 Z" class="logo-accent" opacity="0.8"/>
                    </svg>
                </a>
            </div>
            <h1 style="color: #5B2AE0; margin: 0;">Carousel Button Test Page</h1>
        </div>
    </header>

    <main style="padding: 2rem; max-width: 1200px; margin: 0 auto;">
        <div class="status-info">
            <h2>Carousel Button Fix Test</h2>
            <p>This page tests the fixed carousel button functionality. The issues that were addressed:</p>
            <ul>
                <li>✅ Removed problematic <code>removeEventListener</code> calls that could interfere with button clicks</li>
                <li>✅ Fixed button state logic to properly enable buttons when there are sufficient slides</li>
                <li>✅ Enhanced initialization with better error handling and debugging</li>
                <li>✅ Added comprehensive logging to track button interactions</li>
                <li>✅ Implemented proper event prevention and stop propagation</li>
            </ul>
        </div>

        <div class="test-controls">
            <h3>Manual Test Controls</h3>
            <p>Use these buttons to test the carousel functionality programmatically:</p>
            <button class="test-button" onclick="runDiagnostics()">Run Diagnostics</button>
            <button class="test-button" onclick="testNextSlide()">Test Next Slide</button>
            <button class="test-button" onclick="testPreviousSlide()">Test Previous Slide</button>
            <button class="test-button" onclick="clearResults()">Clear Results</button>
            <button class="test-button" onclick="simulateButtonClicks()">Simulate Button Clicks</button>
        </div>

        <div id="test-results" class="test-results">
            <p>Test results will appear here. Open browser console for detailed logs.</p>
        </div>

        <!-- Testimonials Section for Testing -->
        <section class="testimonials test-section">
            <div class="testimonials-container">
                <h2 class="section-title">Testimonials Carousel Test</h2>
                <p>This carousel should have working navigation buttons. Try clicking the left/right buttons or using keyboard navigation.</p>
                
                <div class="testimonials-carousel" id="testimonials-carousel">
                    <div id="carousel-live-region" aria-live="polite" aria-atomic="true" class="sr-only"></div>
                    <div class="carousel-container">
                        <div class="carousel-track" id="carousel-track">
                            <div class="testimonial-slide">
                                <blockquote class="testimonial-card">
                                    <p class="testimonial-content">"You do all your work with great excellence, MashAllah. May Allah bless you with even greater success. Aameen."</p>
                                    <cite class="testimonial-author"><strong>Rabia Api</strong></cite>
                                </blockquote>
                            </div>
                            <div class="testimonial-slide">
                                <blockquote class="testimonial-card">
                                    <p class="testimonial-content">"Google Ads campaigns brought us more customers than ever before. The ROI has been incredible!"</p>
                                    <cite class="testimonial-author"><strong>David R.</strong></cite>
                                </blockquote>
                            </div>
                            <div class="testimonial-slide">
                                <blockquote class="testimonial-card">
                                    <p class="testimonial-content">"Our Shopify store's conversion rate doubled after their redesign. Amazing work!"</p>
                                    <cite class="testimonial-author"><strong>Amelia T.</strong></cite>
                                </blockquote>
                            </div>
                            <div class="testimonial-slide">
                                <blockquote class="testimonial-card">
                                    <p class="testimonial-content">"TikTok Shop setup was seamless. Sales started rolling in within the first week."</p>
                                    <cite class="testimonial-author"><strong>Marcus K.</strong></cite>
                                </blockquote>
                            </div>
                            <div class="testimonial-slide">
                                <blockquote class="testimonial-card">
                                    <p class="testimonial-content">"Email marketing flows generated 40% more revenue. Highly recommend their services!"</p>
                                    <cite class="testimonial-author"><strong>Sarah L.</strong></cite>
                                </blockquote>
                            </div>
                        </div>
                    </div>

                    <!-- Carousel Controls -->
                    <div class="carousel-controls">
                        <button class="carousel-btn" id="carousel-prev" aria-label="Previous testimonial">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="15,18 9,12 15,6"></polyline>
                            </svg>
                        </button>
                        <button class="carousel-btn" id="carousel-next" aria-label="Next testimonial">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9,18 15,12 9,6"></polyline>
                            </svg>
                        </button>
                    </div>

                    <!-- Carousel Indicators -->
                    <div class="carousel-indicators" id="carousel-indicators"></div>
                </div>
            </div>
        </section>

        <div class="test-section">
            <h3>Expected Behavior</h3>
            <ul>
                <li>✅ Buttons should be visible and clickable (since we have 5 slides and show 3 at desktop)</li>
                <li>✅ Clicking buttons should move the carousel smoothly</li>
                <li>✅ Keyboard navigation (Tab to buttons, Enter/Space to activate) should work</li>
                <li>✅ Console should show detailed logs of button interactions</li>
                <li>✅ Auto-play should pause when buttons are used and resume after delay</li>
                <li>✅ Indicators (dots) should update when buttons are used</li>
                <li>✅ ARIA announcements should work for screen readers</li>
            </ul>
        </div>
    </main>

    <script src="script.js"></script>
    <script>
        let testResultsElement;
        let carouselController;

        // Wait for page load and get carousel controller instance
        window.addEventListener('load', () => {
            testResultsElement = document.getElementById('test-results');
            // Find the carousel controller instance
            setTimeout(() => {
                // The controller should be available as a global or we can access it through the DOM
                logResult('Page loaded, carousel should be initialized.');
                
                // Check if carousel elements exist
                const carousel = document.getElementById('testimonials-carousel');
                const prevBtn = document.getElementById('carousel-prev');
                const nextBtn = document.getElementById('carousel-next');
                
                logResult(`Elements found: carousel=${!!carousel}, prevBtn=${!!prevBtn}, nextBtn=${!!nextBtn}`);
            }, 1000);
        });

        function logResult(message) {
            if (testResultsElement) {
                const timestamp = new Date().toLocaleTimeString();
                testResultsElement.innerHTML += `<div>[${timestamp}] ${message}</div>`;
                testResultsElement.scrollTop = testResultsElement.scrollHeight;
            }
            console.log(message);
        }

        function runDiagnostics() {
            logResult('=== RUNNING CAROUSEL DIAGNOSTICS ===');
            
            // Check elements
            const carousel = document.getElementById('testimonials-carousel');
            const track = document.getElementById('carousel-track');
            const prevBtn = document.getElementById('carousel-prev');
            const nextBtn = document.getElementById('carousel-next');
            const slides = document.querySelectorAll('.testimonial-slide');
            
            logResult(`Found elements: carousel=${!!carousel}, track=${!!track}, prevBtn=${!!prevBtn}, nextBtn=${!!nextBtn}, slides=${slides.length}`);
            
            if (prevBtn) {
                logResult(`Previous button state: disabled=${prevBtn.disabled}, display=${prevBtn.style.display || 'default'}, pointerEvents=${prevBtn.style.pointerEvents || 'default'}`);
                logResult(`Previous button has listeners: ${prevBtn.hasAttribute('data-listeners-setup')}`);
            }
            
            if (nextBtn) {
                logResult(`Next button state: disabled=${nextBtn.disabled}, display=${nextBtn.style.display || 'default'}, pointerEvents=${nextBtn.style.pointerEvents || 'default'}`);
                logResult(`Next button has listeners: ${nextBtn.hasAttribute('data-listeners-setup')}`);
            }
            
            // Try to call test methods if available
            try {
                // Look for carousel instance in window scope or try to access it
                if (window.carouselInstance) {
                    window.carouselInstance.testCarouselFunctionality();
                    logResult('✅ Carousel test methods called successfully');
                } else {
                    logResult('⚠️ Carousel instance not found in global scope');
                }
            } catch (error) {
                logResult(`❌ Error calling carousel test methods: ${error.message}`);
            }
            
            logResult('=== DIAGNOSTICS COMPLETE ===');
        }

        function testNextSlide() {
            logResult('Testing next slide functionality...');
            const nextBtn = document.getElementById('carousel-next');
            if (nextBtn) {
                nextBtn.click();
                logResult('✅ Next button clicked programmatically');
            } else {
                logResult('❌ Next button not found');
            }
        }

        function testPreviousSlide() {
            logResult('Testing previous slide functionality...');
            const prevBtn = document.getElementById('carousel-prev');
            if (prevBtn) {
                prevBtn.click();
                logResult('✅ Previous button clicked programmatically');
            } else {
                logResult('❌ Previous button not found');
            }
        }

        function simulateButtonClicks() {
            logResult('=== SIMULATING BUTTON CLICKS ===');
            const prevBtn = document.getElementById('carousel-prev');
            const nextBtn = document.getElementById('carousel-next');
            
            if (!prevBtn || !nextBtn) {
                logResult('❌ Buttons not found for simulation');
                return;
            }
            
            let clickCount = 0;
            const maxClicks = 6;
            
            const simulateClick = () => {
                if (clickCount >= maxClicks) {
                    logResult('=== SIMULATION COMPLETE ===');
                    return;
                }
                
                const button = clickCount % 2 === 0 ? nextBtn : prevBtn;
                const buttonName = clickCount % 2 === 0 ? 'Next' : 'Previous';
                
                logResult(`Simulating ${buttonName} button click (${clickCount + 1}/${maxClicks})`);
                button.click();
                clickCount++;
                
                setTimeout(simulateClick, 1500);
            };
            
            simulateClick();
        }

        function clearResults() {
            if (testResultsElement) {
                testResultsElement.innerHTML = '<p>Test results cleared. Ready for new tests.</p>';
            }
        }

        // Auto-run diagnostics after a delay
        setTimeout(() => {
            logResult('Auto-running initial diagnostics...');
            runDiagnostics();
        }, 2000);
    </script>
</body>
</html>